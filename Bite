local RunService = game:GetService("RunService")
local plr = game.Players.LocalPlayer
local chr = plr.Character or plr.CharacterAdded:Wait()
local hrp = chr:WaitForChild("HumanoidRootPart")
local hum = chr:WaitForChild("Humanoid")
local rs = game:GetService("ReplicatedStorage")
local dmg = true

local found = false

for _, v in ipairs(game.Workspace.CurrentRooms:WaitForChild(game.ReplicatedStorage.GameData.LatestRoom.Value):GetDescendants()) do
    if v.Name == "Wardrobe" then
        found = true
        break
    end
end

if not found then return end

local function jc()
local shadow=game:GetObjects("rbxassetid://11503625408")[1]
local gui = Instance.new("ScreenGui",game.Players.LocalPlayer.PlayerGui)
local sound = Instance.new("Sound")
	     sound.SoundId = "rbxassetid://109961399514238"
     	sound.Looped = false
     	sound.Parent = gui
     	sound.Volume = 1
	     sound:Play()
			shadow.Parent = gui
			shadow.Visible = true
			local l__ImageLabel__1 = shadow.ImageLabel;
			local v2 = Random.new();
			local l__SizeValue__3 = shadow.SizeValue;
			local v4 = math.random(1, 6);
			if v4 == 1 then
				l__ImageLabel__1.Image = "rbxassetid://86224028365005";
			end;
			if v4 == 2 then
				l__ImageLabel__1.Image = "rbxassetid://86224028365005";
			end;
			if v4 == 3 then
				l__ImageLabel__1.Image = "rbxassetid://86224028365005";
			end;
			if v4 == 4 then
				l__ImageLabel__1.Image = "rbxassetid://86224028365005";
			end;
			if v4 == 5 then
				l__ImageLabel__1.Image = "rbxassetid://86224028365005";
			end;
			if v4 == 6 then
				l__ImageLabel__1.Image = "rbxassetid://86224028365005";
			end;
			shadow.Jumpscare:Play();
			for v5 = 1, 30 do
				local v6 = math.random(1, 3);
				if v6 == 1 then
					shadow.BackgroundColor3 = Color3.new(0, 0, 0);
					l__ImageLabel__1.ImageColor3 = Color3.new(1, 1, 1);
				end;
				if v6 == 2 then
					shadow.BackgroundColor3 = Color3.new(1, 1, 1);
					l__ImageLabel__1.ImageColor3 = Color3.new(0, 0, 0);
				end;
				if v6 == 3 then
					shadow.BackgroundColor3 = Color3.new(1, 0, 0);
					l__ImageLabel__1.ImageColor3 = Color3.new(1, 1, 1);
				end;
				l__ImageLabel__1.Position = UDim2.new(v2:NextNumber(0.4, 0.6), 0, v2:NextNumber(0.45, 0.55), 0);
				l__ImageLabel__1.Size = l__ImageLabel__1.Size + UDim2.new(l__SizeValue__3.Value, 0, l__SizeValue__3.Value, 0);
				l__ImageLabel__1.Rotation = math.random(-10, 10);
				l__SizeValue__3.Value = l__SizeValue__3.Value - 0.01;
				wait(0);
			end;
			l__ImageLabel__1.ImageColor3 = Color3.new(1, 1, 1);
			shadow.BackgroundColor3 = Color3.new(0, 0, 0);
			gui:Destroy()
end

if game.Workspace.CurrentRooms:FindFirstChild("Brbrbr") then return end
local part = Instance.new("Part")
part.Size = Vector3.new(5, 5, 5)
part.Anchored = true
part.Transparency = 1
part.CanCollide = false
part.CastShadow = false
part.Name = "Brbrbr"
part.Parent = workspace.CurrentRooms

local sound = Instance.new("Sound")
sound.Parent = part
sound.SoundId = "rbxassetid://108553166609538"
sound.Volume = 0.6
sound.PlaybackSpeed = 0.2
sound.MaxDistance = 50
sound.Looped = true
sound:Play()

local billboard = Instance.new("BillboardGui")
billboard.AlwaysOnTop = true
billboard.Size = UDim2.new(15, 0, 15, 0)
billboard.SizeOffset = Vector2.new(0, 0.2)
billboard.Parent = part
billboard.Adornee = part

local imageLabel = Instance.new("ImageLabel")
imageLabel.Size = UDim2.new(1, 0, 1, 0)
imageLabel.BackgroundTransparency = 1
imageLabel.Image = "rbxassetid://86224028365005"
imageLabel.Parent = billboard

local TweenService = game:GetService("TweenService")
local Camera = workspace.CurrentCamera

local tweenInfo = TweenInfo.new(
    0.8,
    Enum.EasingStyle.Sine,
    Enum.EasingDirection.InOut
)

local currentTween
local isVisible = false

local function tween(goal)
    if currentTween then currentTween:Cancel() end
    currentTween = TweenService:Create(imageLabel, tweenInfo, {ImageTransparency = goal})
    currentTween:Play()
end

RunService.RenderStepped:Connect(function()
    local camCF = Camera.CFrame
    local camPos = camCF.Position
    local camLook = camCF.LookVector
    
    local dirToPart = (part.Position - camPos).Unit

    local dot = camLook:Dot(dirToPart)

    local looking = dot >= 0.65
    if looking ~= isVisible then
        isVisible = looking

        if isVisible then
            tween(1)
        else
            tween(0.8)
        end
    end
end)

for _, v in ipairs(game.Workspace.CurrentRooms:WaitForChild(game.ReplicatedStorage.GameData.LatestRoom.Value):GetDescendants()) do
		if v.Name == "Wardrobe" then
			if v:FindFirstChild("Model") and v.Model:FindFirstChild("CollisionWedge") then
                part.CFrame = v.Model.CollisionWedge.CFrame * CFrame.new(0, 0, -1)
            end
		end
end

    task.spawn(function()
		while dmg == true do
			task.wait(0.1)
			if not dmg then break end
			
			local player = game.Players.LocalPlayer
			local char = player.Character
			local hum = char and char:FindFirstChildOfClass("Humanoid")
			local hrp = char and char:FindFirstChild("HumanoidRootPart")
			
			if hum and hrp and (hrp.Position - part.Position).Magnitude <= 1 then
			if char:GetAttribute("Hiding") then
	            hum.Health -= 5
                game:GetService("ReplicatedStorage").GameStats["Player_".. game.Players.LocalPlayer.Name].Total.DeathCause.Value = "B1t3"
                
                if hum.Health <= 0 then
                dmg = false          
                jc()
                char:SetAttribute("Hiding", false)
                end
                
            end
            end
		end
	end)

game.ReplicatedStorage.GameData.LatestRoom.Changed:Wait()
dmg = false
part:Destroy()
